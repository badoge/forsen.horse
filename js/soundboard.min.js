let infoModal;window.onload=async function(){infoModal=new bootstrap.Modal(document.getElementById("infoModal"));let t=await fetch("/soundboard/samples.json"),e=await t.json(),a=await fetch("/soundboard/categories.json"),n=await a.json();const o=e.reduce(((t,e)=>{const a=e.category;return t[a]||(t[a]=[]),t[a].push(e),t}),{});for(const t of Object.keys(o)){const e=o[t];if(!n[t])continue;document.getElementById("dank").innerHTML+=`<div class="category-label"><h1 class="display-5">${t}</h1>\n    <small class="text-body-secondary">${n[t].description}</small><br></div>`;const a=document.createElement("div");a.classList="category-div";for(let o=0;o<e.length;o++){const l=document.createElement("div");l.classList=`btn-group sample-div ${e[o].source||e[o].description?"has-metadata":"no-metadata"} m-2`,l.role="group",l["aria-label"]=e[o].name+"button group";const s=document.createElement("button");s.classList=`btn ${n[t].class} info-button p-1`,s.type="button",s.title="Sample info",s.dataset.category=e[o].category,s.dataset.name=e[o].name,s.dataset.source=e[o].source||"no source yet",s.dataset.description=e[o].description||"no description yet",s.innerHTML='<i class="material-icons notranslate">info</i>';const i=document.createElement("button");i.innerText=e[o].name.replace(".mp3",""),i.type="button",i.classList=`btn ${n[t].class} play-button`,i.dataset.category=e[o].category,i.dataset.name=e[o].name,l.appendChild(i),l.appendChild(s),a.appendChild(l),document.getElementById("dank").appendChild(a)}}document.addEventListener("click",(function(t){if("BUTTON"===t.target.nodeName&&(t.target.classList.contains("play-button")&&playSample(t.target.dataset.category,t.target.dataset.name),t.target.classList.contains("info-button")&&(document.getElementById("infoModalLabel").innerHTML=t.target.dataset.name.replace(".mp3",""),document.getElementById("infoModalBody").innerHTML=`\n        <b><i class="material-icons notranslate">label</i> Name:</b> ${t.target.dataset.name.replace(".mp3","")}<br>\n        <b><i class="material-icons notranslate">category</i> Category:</b> ${t.target.dataset.category}<br>\n        <b><i class="material-icons notranslate">source</i> Source:</b> ${t.target.dataset.source}<br>\n        <b><i class="material-icons notranslate">description</i> Description:</b> ${t.target.dataset.description}<br><br>\n        <button \n        type="button" \n        class="btn btn-secondary" \n        onclick="copyLink(event,'https://badoge.github.io/soundboard/forsen/${t.target.dataset.category}/${t.target.dataset.name}')">\n        <i class="material-icons notranslate">content_copy</i> Copy direct link \n        </button>`,infoModal.show())),"showAll"==t.target.id){let t=document.querySelectorAll(".has-metadata"),e=document.querySelectorAll(".no-metadata");for(let e=0;e<t.length;e++)t[e].style.display="";for(let t=0;t<e.length;t++)e[t].style.display=""}if("showWithMetadata"==t.target.id){let t=document.querySelectorAll(".has-metadata"),e=document.querySelectorAll(".no-metadata");for(let e=0;e<t.length;e++)t[e].style.display="";for(let t=0;t<e.length;t++)e[t].style.display="none"}if("showWithoutMetadata"==t.target.id){let t=document.querySelectorAll(".has-metadata"),e=document.querySelectorAll(".no-metadata");for(let e=0;e<t.length;e++)t[e].style.display="none";for(let t=0;t<e.length;t++)e[t].style.display=""}}))};let isPlaying=!1;async function playSample(t,e){if(document.getElementById("allowOverlap").checked||!isPlaying)try{audio=new Audio(`https://badoge.github.io/soundboard/forsen/${t}/${e}`),await audio.play(),isPlaying=!0,audio.addEventListener("ended",(function(){isPlaying=!1}))}catch(t){isPlaying=!1}}function copyLink(t,e){navigator.clipboard.writeText(encodeURI(e)),t.target.innerHTML="Link copied :)",setTimeout((()=>{t.target.innerHTML='<i class="material-icons notranslate">content_copy</i> Copy direct link '}),2e3)}function search(t){document.getElementById("showAll").checked=!0;let e=t.target.value.toLowerCase(),a=document.querySelectorAll(".category-label"),n=document.querySelectorAll(".category-div");for(let t=0;t<a.length;t++){let o=n[t].querySelectorAll(".sample-div"),l=!0;for(let t=0;t<o.length;t++){o[t].getElementsByTagName("button")[0].textContent.toLowerCase().indexOf(e)>-1?(o[t].style.display="",l=!1):o[t].style.display="none"}a[t].style.display=l?"none":""}}