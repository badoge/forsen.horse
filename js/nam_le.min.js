function showError(t){$("#modalPanicBody").html(t),app.modals.error.show()}const app={consts:{hardModeAttempts:6,disparity:{soft:{Date:2,Month:1,FullYear:1},hard:{Date:7,Month:3,FullYear:2}},emojis:{attempt1:"üü¢",attempt0:"üî¥",correct:"üü©",close:"üü®",far:"üü•",miss:"‚¨õ"},midnightTail:"T00:00:00",daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],datePickerTypeHints:{datetimepicker:"Pick date from a calendar view. Simple, effective, elegant.",flipbox:"Scroll or swipe to select day, month, and year. Includes color coded hints!",date:"Uses native calendar interface to pick date. Visual style may vary - depending on your browser.",text:"Input date as text - manually, with no calendar interface."},datePickerFormats:{"MM-DD-YYYY":"m-d-Y","DD-MM-YYYY":"d-m-Y","YYYY-MM-DD":"Y-m-d"},dateElements:{"YYYY-MM-DD":["FullYear","Month","Date"],"MM-DD-YYYY":["Month","Date","FullYear"],"DD-MM-YYYY":["Date","Month","FullYear"]},mediasrc:"/data/nam_le-sources.json",startDate:new Date("2022-05-24T00:00:00")},datePickerOptions:{theme:"default",yearStart:2010,yearEnd:(new Date).getFullYear(),dayOfWeekStart:1,mask:!0,defaultSelect:!1,closeOnDateSelect:!1,validateOnBlur:!1,todayButton:!1,timepicker:!1,onSelectDate:()=>{app.aux.renderAdvice(null)},minDate:void 0,maxDate:void 0,startDate:void 0,format:"Y-m-d"},game:{victory:0,tries:[],issue:0},settings:{dateOrder:(()=>{try{const t=new Intl.DateTimeFormat(navigator.language).formatToParts();switch(t[0].type){case"month":return"MM-DD-YYYY";case"day":return"DD-MM-YYYY";case"year":return"YYYY-MM-DD";default:throw new Error("Cannot define first element of date.",t[0])}}catch(t){return"DD-MM-YYYY"}})(),calendar:!0,inputTypeOverrideHappened:!1,inputType:"legacy",hardMode:!1,zoomImageOnClick:!0,highContrastMode:!1,darkMode:(()=>{try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(t){return!1}})()},announcements:{hardModeOffer:0,highContrastModeAdded:1},stats:{games:0,wins:0,streak:0,min:-1,max:-1,avg:0,lastissue:0,lastvisit:null},currentIssue:0,time:new Date,src:{},target:new Date,min:null,max:null,emojiField:[],modals:{},tooltips:[],popovers:[],html:{countdown:$("span#st_countdown"),shareBtn:$("button#doShare"),loader:{img:$("div#loader img.loading-placeholder"),text:$("div#loader div.loading-placeholder"),container:$("div#loader")},game:{frame:$("img#picframe"),controlArea:$("div#userControlArea"),guesses:$("div.user-guess-history"),container:$("div#game")},gameinfo:{name:$("div#frameGame"),link:$("a#frameVod"),container:$("div.user-extended-info")},hardMode:{hmAttemptCounter:$("#hardModeCounter"),container:$("div.user-guess-hard-mode")},controls:{inputIcon:$("#iCalIcon"),inputDate:$("input#iAttempt"),inputFlip:$("#forsleFlipper"),submitBtn:$("button#iSubmit"),container:$("div.user-guess-input")},buttons:{share:$("#shareButton"),about:$("#aboutButton"),stats:$("#statsButton"),settings:$("#settingsButton")},settings:{datefmt:$("select#opt_DateOrderSelect"),calendar:$("#opt_CalendarInput"),calAdvice:$("#calendarAdvice"),hardMode:$("input#opt_HardMode"),highContrastMode:$("input#opt_HighContrastMode"),zoomImageOnClick:$("input#opt_ZoomImageOnClick"),darkMode:$("input#opt_DarkMode")},stats:{congrats:$("#st_statcongrats"),shame:$("#st_statshame"),table:$("#tableWithStats"),tries:$("#st_tries"),games:$("#st_games"),winrate:$("#st_winrate"),streak:$("#st_streak"),min:$("#st_min"),max:$("#st_max"),avgtimes:$("#st_avgtimes"),title:$("#modalVictoryTitle")},modals:{error:$("#modalPanic"),welcome:$("#modalWelcome"),stats:$("#modalVictory"),settings:$("#modalSettings")},dynamic:{}},aux:{nullFunction:()=>{},isLeapYear:t=>t%4==0&&t%100!=0||t%400==0,sprinkleSomeLove:(t=1e3)=>{startConfetti(),setTimeout(stopConfetti,t)},hideAllModals:()=>{Object.keys(app.modals).forEach((t=>app.modals[t].hide()))},renderNotifications:()=>{if(!app.game.victory&&!app.announcements.hardModeOffer&&app.stats.games>5&&app.stats.avg<7){app.announcements.hardModeOffer=new Date,app.aux.save();const t=app.html.buttons.settings;"tooltip"===t.attr("data-bs-toggle")&&(t.tooltip("dispose"),t.removeAttr("title"),t.removeAttr("data-bs-original-title")),t.popover({placement:"bottom",trigger:"manual",html:!0,content:'<img alt="nam" class="inline-smol" src="/pics/nam_le/nam.png" width="16">&nbsp;&nbsp;Game too easy?<br>Try <b>‚ô®Ô∏è Hard mode</b>! '}),t.popover("show");const a=()=>t.popover("hide");t.on("mouseover",a),t.on("click",a)}},renderAdvice:(t="")=>{if(t){app.html.dynamic.inputAdviceFriend&&app.html.dynamic.inputAdviceFriend.dispose(),app.html.controls.container.addClass("bad-input");const a=app.html.controls.inputDate.is(":visible")?app.html.controls.inputDate:app.html.controls.inputDate.parent();a.attr("data-bs-content",t),app.html.dynamic.inputAdviceFriend=new bootstrap.Popover(a,{template:'<div class="popover custom-popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header bg-danger"></h3><div class="popover-body bg-danger"></div></div>',html:!0,placement:"bottom",trigger:"manual"}),app.html.dynamic.inputAdviceFriend.show()}else app.html.controls.inputDate.attr("data-bs-content",""),app.html.controls.inputDate.parent().attr("data-bs-content",""),app.html.controls.container.removeClass("bad-input"),app.html.dynamic.inputAdviceFriend&&(app.html.dynamic.inputAdviceFriend.dispose(),delete app.html.dynamic.inputAdviceFriend)},getTZMidnightDateString:t=>(t instanceof Date||(t=new Date(t)),t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0")+app.consts.midnightTail),getUniformedDate:t=>{if(["date","flipbox"].includes(app.settings.inputType))return new Date(t+app.consts.midnightTail);let a=t.split("-");if(3!==a.length)throw new TypeError("Weird date format");const e={};app.consts.dateElements[app.settings.dateOrder].forEach(((t,p)=>{if(e[t]=parseInt(a[p],10),isNaN(e[t]))throw new TypeError("Bad date element: "+a[p])}));const p=app.aux.isLeapYear(e.FullYear),s=app.consts.daysInMonth;switch(s[1]=p?29:28,!0){case e.FullYear<1:throw new RangeError("Invalid year specified: "+e.FullYear);case e.Month<1||e.Month>12:throw new RangeError("Invalid month specified: "+e.Month);case e.Date<1||e.Date>s[e.Month-1]:throw new RangeError("Invalid day specified: "+e.Date)}return["Month","Date"].forEach((t=>{e[t]=String(e[t]).padStart(2,"0")})),new Date(e.FullYear+"-"+e.Month+"-"+e.Date+app.consts.midnightTail)},updateDatePicker:()=>{"datetimepicker"===app.settings.inputType&&app.html.controls.inputDate.datetimepicker(app.datePickerOptions)},isMobileClient:()=>{let t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))},toggleZoomImageOnClick:(t=!1)=>{app.html.game.frame.parent().removeClass("frame-parent-popout"),app.html.game.controlArea.css("visibility","visible"),app.html.game.frame.parent().toggleClass("frame-expandable",app.settings.zoomImageOnClick),t&&app.html.settings.zoomImageOnClick.prop("checked",app.settings.zoomImageOnClick)},toggleDarkMode:(t=!1)=>{document.documentElement.setAttribute("data-bs-theme",app.settings.darkMode?"dark":"light"),t&&app.html.settings.darkMode.prop("checked",app.settings.darkMode)},toggleHighContrastMode:(t=!1)=>{$("body").toggleClass("high-contrast-colors",app.settings.highContrastMode),t&&app.html.settings.highContrastMode.prop("checked",app.settings.highContrastMode)},toggleCalendarInput:(t=!1)=>{switch("legacy"===app.settings.inputType&&(t=!0,app.settings.inputType=app.settings.calendar?"flipbox":"date"),app.settings.inputType){case"flipbox":app.html.controls.inputIcon.hide(),app.html.controls.inputDate.hide(),app.html.controls.inputFlip.forsleFlipper(app,"init"),app.html.controls.inputFlip.show(),app.html.controls.submitBtn.parent().removeClass("input-group-append-fix"),app.html.controls.container.addClass("user-guess-input-flipbox");break;case"datetimepicker":app.html.controls.inputFlip.hide(),app.html.controls.inputIcon.show(),app.html.controls.inputDate.show(),app.html.controls.submitBtn.parent().addClass("input-group-append-fix"),app.html.controls.container.removeClass("user-guess-input-flipbox"),app.html.controls.inputDate.prop("type","text"),app.html.controls.inputDate.attr("inputmode","none"),app.datePickerOptions.format=app.consts.datePickerFormats[app.settings.dateOrder],app.datePickerOptions.startDate=new Date(app.game.tries[app.game.tries.length-1]||app.time),app.datePickerOptions.minDate=app.min||void 0,app.datePickerOptions.maxDate=app.max||void 0,app.aux.updateDatePicker();break;case"date":case"text":default:app.html.controls.inputFlip.hide(),app.html.controls.inputIcon.show(),app.html.controls.inputDate.show(),app.html.controls.submitBtn.parent().addClass("input-group-append-fix"),app.html.controls.container.removeClass("user-guess-input-flipbox"),app.html.controls.inputDate.datetimepicker("destroy"),app.html.controls.inputDate.prop("type",app.settings.inputType),app.html.controls.inputDate.attr("inputmode","numeric"),app.min&&app.html.controls.inputDate.prop("min",app.min.toISOString().split("T")[0]),app.max&&app.html.controls.inputDate.prop("max",app.max.toISOString().split("T")[0]);break}app.html.controls.inputDate.val(""),t&&app.html.settings.calendar.val(app.settings.inputType)},applyCustomDateOrder:(t=!1)=>{app.html.controls.inputDate.prop("placeholder",app.settings.dateOrder),"datetimepicker"===app.settings.inputType&&(app.datePickerOptions.format=app.consts.datePickerFormats[app.settings.dateOrder],app.aux.updateDatePicker(),app.html.controls.inputDate.val("")),document.body.dataset.dateOrder=app.settings.dateOrder,t&&app.html.settings.datefmt.val(app.settings.dateOrder)},applyHardModeBlock:(t=!1)=>{if(app.html.hardMode.container[app.settings.hardMode?"show":"hide"](),app.game.tries.length>0&&(app.html.settings.hardMode.prop("disabled",!0),!app.html.dynamic.tooltipOfHardMode)){const t=app.html.settings.hardMode.parent();t.prop("data-bs-title","This can only be changed before the game starts!"),t.attr("data-bs-toggle","tooltip"),t.attr("data-bs-placement","left");const a=new bootstrap.Tooltip(t);app.html.dynamic.tooltipOfHardMode=a,app.tooltips.push(a)}t&&app.html.settings.hardMode.prop("checked",app.settings.hardMode)},clearField:()=>{app.game.tries.length=0,app.game.victory=0,app.html.controls.inputFlip.forsleFlipper(app,"setDate",app.time),"datetimepicker"===app.settings.inputType&&(app.datePickerOptions.startDate=!1,app.aux.updateDatePicker()),app.html.settings.hardMode.prop("disabled",!1)},fillHMCounter:()=>{let t="";for(let a=app.consts.hardModeAttempts;a>0;a--)t+=app.consts.emojis[a>app.game.tries.length?"attempt1":"attempt0"];app.html.hardMode.hmAttemptCounter.text(t)},fillSrcInfo:()=>{app.src.game?app.html.gameinfo.name.text("üéÆ "+app.src.game):app.html.gameinfo.name.text("");const t=String(app.src.src);t?(app.html.gameinfo.link.prop("href",t),app.html.gameinfo.link.show()):app.html.gameinfo.link.hide()},drawAndCheckUserGuess:(t,a=!1)=>{if(!(t instanceof Date))throw new TypeError("Incorrect type: "+t);let e=!0;const p=document.createElement("div");p.classList.add("user-guess-attempt"),app.html.game.guesses.append(p);const s={},n={};["Date","Month","FullYear"].forEach((o=>{const r=document.createElement("div");r.classList.add("ug-element"),r.classList.add("ug-"+o.toLowerCase());let i=t["get"+o]();n[o]=i,"Month"===o&&(i+=1),r.innerText=String(i).padStart(2,"0"),p.appendChild(r);let l=Math.abs(t["get"+o]()-app.target["get"+o]()),m="";a?m="ug-scoots":0===l?(m="ug-correct",s[o]=app.consts.emojis.correct):(e=!1,l<=app.consts.disparity.soft[o]?(m="ug-close",s[o]=app.consts.emojis.close):l<=app.consts.disparity.hard[o]?(m="ug-far",s[o]=app.consts.emojis.far):(m="ug-incorrect",s[o]=app.consts.emojis.miss)),r.classList.add(m),n[o]=[n[o],m]})),app.html.controls.inputFlip.forsleFlipper(app,"colors",n);const o=t<app.target,r=document.createElement("div");if(r.innerText=app.game.tries.length<2?"üòé‚úåÔ∏è":"ü•≥",p.appendChild(r),a)r.innerText="‚ô®Ô∏è";else{if(!e)switch(r.innerText=o?"‚è©":"‚è™",o&&(!app.min||t.getTime()>=app.min.getTime())&&(app.min=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1)),o||app.max&&!(t.getTime()<=app.max.getTime())||(app.max=new Date(t.getFullYear(),t.getMonth(),t.getDate()-1)),app.settings.inputType){case"datetimepicker":app.datePickerOptions.startDate=new Date(t),app.datePickerOptions.minDate=app.min||void 0,app.datePickerOptions.maxDate=app.max||void 0,app.aux.updateDatePicker();break;case"date":app.min&&app.html.controls.inputDate.prop("min",app.min.toISOString().split("T")[0]),app.max&&app.html.controls.inputDate.prop("max",app.max.toISOString().split("T")[0]);break}s.direction=r.innerText,app.emojiField.push(s)}return r.classList.add("ug-element","ug-direction"),app.aux.fillHMCounter(),e},load:()=>{try{let t=localStorage.getItem("nam_le-settings");t=JSON.parse(t),Object.keys(app.settings).forEach((a=>{t.hasOwnProperty(a)&&(app.settings[a]=t[a])}))}catch(t){try{let t=localStorage.getItem("forsenle-settings");t=JSON.parse(t),Object.keys(app.settings).forEach((a=>{t.hasOwnProperty(a)&&(app.settings[a]=t[a])}))}catch(t){}}try{let t=localStorage.getItem("nam_le-announcements");t=JSON.parse(t),Object.keys(app.announcements).forEach((a=>{t.hasOwnProperty(a)&&(app.announcements[a]=t[a])}))}catch(t){}try{let t=localStorage.getItem("nam_le-state");t=JSON.parse(t),Object.keys(app.game).forEach((a=>{t.hasOwnProperty(a)&&(app.game[a]=t[a])}))}catch(t){}try{let t=localStorage.getItem("nam_le-stats");t=JSON.parse(t),Object.keys(app.stats).forEach((a=>{t.hasOwnProperty(a)&&(app.stats[a]=t[a])})),app.stats.lastvisit=new Date(app.stats.lastvisit)}catch(t){}app.settings.inputTypeOverrideHappened||"datetimepicker"===app.settings.inputType&&(app.settings.inputType="flipbox"),app.settings.inputTypeOverrideHappened=!0,app.aux.toggleDarkMode(!0),app.aux.toggleHighContrastMode(!0),app.aux.applyHardModeBlock(!0),app.aux.applyCustomDateOrder(!0),app.aux.toggleCalendarInput(!0),app.aux.toggleZoomImageOnClick(!0),app.html.settings.calAdvice.text(app.consts.datePickerTypeHints[app.settings.inputType]||app.html.settings.calAdvice.attr("data-fallback-text"))},restoreField:()=>{app.aux.fillHMCounter(),app.game.tries.forEach(((t,a,e)=>{try{if(t.endsWith("Z")){const p=new Date(t),s=app.aux.getTZMidnightDateString(p);e[a]=s,app.aux.drawAndCheckUserGuess(new Date(s))}else app.aux.drawAndCheckUserGuess(new Date(t))}catch(t){}})),!app.game.victory&&app.settings.hardMode&&app.game.tries.length>=app.consts.hardModeAttempts&&(app.game.victory=-1),0!==app.game.victory&&(app.game.victory<0&&app.aux.drawAndCheckUserGuess(app.target,!0),app.aux.fillSrcInfo(),app.html.gameinfo.container.show(),app.html.controls.container.hide(),app.html.hardMode.container.hide(),app.aux.victory(2e3))},save:()=>{localStorage.setItem("nam_le-state",JSON.stringify(app.game)),localStorage.setItem("nam_le-stats",JSON.stringify(app.stats)),localStorage.setItem("nam_le-settings",JSON.stringify(app.settings)),localStorage.setItem("nam_le-announcements",JSON.stringify(app.announcements))},share:()=>{try{let t="NaM______________________le ";if(app.game.victory){t+=`#${app.currentIssue+1} - ${app.game.victory>0?"üë§ in "+app.game.tries.length:"üôÖ"}${app.settings.hardMode?" ‚ô®Ô∏è":""}`;let a="",e=0;app.emojiField.forEach((p=>{let s="";app.consts.dateElements[app.settings.dateOrder].forEach((t=>{s+=p[t]})),s+=p.direction,a!==s&&(a&&(t+="\n"+a),e>1&&(t+="√ó"+e),e=0),a=s,e+=1})),a&&(t+="\n"+a),e>1&&(t+="√ó"+e)}let a=Math.round(100*app.stats.wins/Math.max(app.stats.games,1));if(t+=`\nüßÆ Games: ${app.stats.games} (${a}%, ${app.stats.streak>0?"+":""}${app.stats.streak})`,app.stats.wins>0&&(t+=` Avg: ${app.stats.avg.toFixed(2)} (${app.stats.min}~${app.stats.max})`),t+=`\n${window.location.origin+window.location.pathname}`,!app.game.victory&&app.stats.games<1&&(t="üßî NaM______________________le\n"+window.location.origin+window.location.pathname),app.aux.isMobileClient()){let a={text:t};if(navigator.share&&navigator.canShare&&navigator.canShare(a))return navigator.share(a).catch((t=>{if(t instanceof Error)switch(t.name){case"AbortError":return;default:throw t}})).then((()=>"Results shared!"),(t=>{throw t}))}return navigator.clipboard.writeText(t).then((()=>"Copied to clipboard!"))}catch(t){return Promise.reject(t)}},victory:(t=0)=>{if(0!==app.game.victory){const t=app.game.victory>0;app.html.stats.title.text("üë§ Game over!"),app.html.stats[t?"congrats":"shame"].show(),app.html.countdown.parent().show()}(app.game.victory||app.stats.games>0)&&(app.html.stats.tries.text(app.game.tries.length),Object.keys(app.stats).forEach((t=>{switch(t){case"avg":app.html.stats.avgtimes.text(app.stats[t].toFixed(2));break;case"wins":let a=100*app.stats.wins/Math.max(app.stats.games,1);app.html.stats.winrate.text(Math.round(a)+"%");break;case"min":case"max":app.html.stats[t].text(app.stats[t]<0?"-":app.stats[t]);break;default:if(!app.html.stats.hasOwnProperty(t))return;app.html.stats[t].text(app.stats[t]);break}}))),app.html.modals.stats.toggleClass("fade",t>0),setTimeout((()=>{app.game.victory>0&&t>0&&app.aux.sprinkleSomeLove(t/2),t>0&&app.aux.hideAllModals(),app.modals.stats.show()}),t)}}};window.onload=function(){Object.keys(app.html.modals).forEach((t=>{app.modals[t]=new bootstrap.Modal(app.html.modals[t])})),app.aux.load(),fetch(app.consts.mediasrc).then((t=>t.json())).then((t=>{if(app.currentIssue=Math.floor((app.time.getTime()-app.consts.startDate.getTime())/864e5),app.currentIssue<0)return app.html.loader.img.prop("src","/pics/forsenle/godseed.gif"),void app.html.loader.text.html("<small><i>Generating god seed...</i></small><br>Your game starts tomorrow!");app.currentIssue!==app.game.issue&&(app.currentIssue-app.stats.lastissue!=1&&(app.stats.streak=0),app.game.issue=app.currentIssue,app.aux.clearField()),app.stats.lastvisit?app.aux.renderNotifications():(app.html.modals.welcome.addClass("fade"),app.modals.welcome.show(),app.announcements.highContrastModeAdded=new Date,app.aux.save());const a=app.currentIssue%t.length;app.src=t[a],app.target=new Date(app.src.date.replace("Z","")),app.html.game.frame.prop("src",app.src.link),app.html.game.frame.on("load",(()=>{app.aux.restoreField(),app.html.loader.container.hide(),app.html.game.container.show()})),app.html.game.frame.on("error",(t=>{showError('Stream image could not be loaded!<br><br>Try refreshing the page. If this happens again, please <a href="mailto:admin@g7eternal.com?subject=NaM_le%20not%20working%20(missing%20image)">notify me</a> about the problem.'),app.html.loader.img.prop("src","/pics/nam_le/cry.gif"),app.html.loader.text.html("Something broke!<br>Please try again later"),app.html.loader.container.show(),app.html.game.container.hide()}))})).catch((t=>{const a=encodeURIComponent(t instanceof Error?t.message:String(t));showError(`An error occured while retrieving list of stream frames.<br>Try refreshing the page. If this happens again, please <a href="mailto:admin@g7eternal.com?subject=NaM_le%20not%20working%20(JSON parse)&body=Error:%20${encodeURIComponent(t instanceof Error?t.name:"Exception")}:%20${a}%0D%0A${encodeURIComponent(t instanceof Error?t.stack:"(stack not available)")}">notify me</a> about the problem.<br><br><em>ERROR: ${decodeURIComponent(a)}</em>`),app.html.loader.img.prop("src","/pics/nam_le/cry.gif"),app.html.loader.text.html("Something broke!<br>Please try again later")}));const t=new Date(app.time.getFullYear(),app.time.getMonth(),app.time.getDate()+1),a=setInterval((()=>{let e=Math.floor((t.getTime()-Date.now())/1e3);if(e<0)return clearInterval(a);app.html.countdown.text(`${String(Math.floor(e/3600)).padStart(2,"0")}:${String(Math.floor(e%3600/60)).padStart(2,"0")}:${String(e%60).padStart(2,"0")}`)}),1e3);app.html.controls.submitBtn.on("click",(t=>{t.target.disabled=!0,"datetimepicker"===app.settings.inputType&&app.html.controls.inputDate.datetimepicker("hide"),app.aux.renderAdvice(null);try{let a=app.html.controls.inputDate.val();if("flipbox"===app.settings.inputType&&(a=app.html.controls.inputFlip.forsleFlipper(app,"getDate")),!a)throw new Error("Please provide a date!");try{if(a=app.aux.getUniformedDate(a),!(a instanceof Date)||isNaN(a))throw new Error("Malformed date")}catch(t){if("RangeError"===t.name)throw t;throw new Error("Please provide a valid date!")}app.game.tries.push(app.aux.getTZMidnightDateString(a)),app.aux.applyHardModeBlock();if(app.aux.drawAndCheckUserGuess(a)?app.game.victory=1:app.settings.hardMode&&app.game.tries.length>=app.consts.hardModeAttempts&&(app.game.victory=-1),0!==app.game.victory){app.stats.lastissue=app.currentIssue;let t=app.stats.avg*app.stats.games;app.stats.games+=1,app.game.victory*app.stats.streak<0&&(app.stats.streak=0),app.stats.streak+=app.game.victory,app.game.victory>0&&(app.stats.wins+=1,app.stats.min<0&&(app.stats.min=app.game.tries.length),app.stats.min=Math.min(app.stats.min,app.game.tries.length),app.stats.max<0&&(app.stats.max=app.game.tries.length),app.stats.max=Math.max(app.stats.max,app.game.tries.length),app.stats.avg=(t+app.game.tries.length)/app.stats.games),app.game.victory<0&&setTimeout((()=>{app.aux.drawAndCheckUserGuess(app.target,!0)}),1500),app.aux.fillSrcInfo(),app.html.gameinfo.container.show(),app.html.controls.container.hide(),app.html.hardMode.container.hide(),app.aux.victory(2e3+1e3*(app.game.victory<0))}app.aux.save(),setTimeout((()=>{t.target.disabled=!1}),1e3)}catch(a){app.aux.renderAdvice(String(a.message||a).replace(/\n/g,"<br>")),t.target.disabled=!1}})),app.html.controls.inputDate.on("keydown",(t=>{"Enter"!==t.code&&"NumpadEnter"!==t.code||app.html.controls.submitBtn.click(),app.aux.renderAdvice(null)})),app.html.buttons.share.on("click",(t=>{const a=t.target;a.disabled=!0,app.aux.share().then((t=>{let e=a.innerText;a.innerText="‚úîÔ∏è "+t,a.classList="btn btn-success",setTimeout((()=>{a.innerText=e,a.disabled=!1,a.classList="btn btn-primary"}),2323)})).catch((t=>{a.innerText="üõë Sharing failed!",a.classList="btn btn-warning"}))})),app.html.buttons.stats.on("click",app.aux.victory),app.html.buttons.settings.on("click",(()=>{app.modals.settings.show()})),app.html.buttons.about.on("click",(()=>{app.html.modals.welcome.removeClass("fade"),app.modals.welcome.show()})),app.html.game.frame.parent().on("click",(()=>{app.settings.zoomImageOnClick&&(app.html.game.frame.parent().toggleClass("frame-parent-popout"),app.html.game.controlArea.css("visibility",((t,a)=>"visible"===a?"hidden":"visible")))})),app.html.settings.hardMode.on("change",(t=>{app.settings.hardMode=t.target.checked,app.aux.save(),app.aux.applyHardModeBlock()})),app.html.settings.darkMode.on("change",(t=>{app.settings.darkMode=t.target.checked,app.aux.save(),app.aux.toggleDarkMode()})),app.html.settings.highContrastMode.on("change",(t=>{app.settings.highContrastMode=t.target.checked,app.aux.save(),app.aux.toggleHighContrastMode()})),app.html.settings.zoomImageOnClick.on("change",(t=>{app.settings.zoomImageOnClick=t.target.checked,app.aux.save(),app.aux.toggleZoomImageOnClick()})),app.html.settings.calendar.on("change",(t=>{t.target.value&&(app.settings.inputType=t.target.value,app.aux.save(),app.aux.toggleCalendarInput(),app.html.settings.calAdvice.text(app.consts.datePickerTypeHints[t.target.value]||app.html.settings.calAdvice.attr("data-fallback-text")))})),app.html.settings.datefmt.on("change",(t=>{app.settings.dateOrder=t.target.value,app.aux.save(),app.aux.applyCustomDateOrder()}));[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map((t=>new bootstrap.Tooltip(t)))};