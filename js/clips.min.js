async function loadClips(){let e=new DataTable("#clipsTable",{language:{emptyTable:'<div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div> Loading clips list...'}});try{let t=await fetch("/clips/clips.min.json"),n=await t.json(),r=[];for(let e=0;e<n.length;e++){let t=n[e].creator_name||"no username";"livestreamfails.com mirror"==t&&(t=`<a href="${n[e].reddit_link}" target="_blank" rel="noopener noreferrer" class="no-decoration">livestreamfails.com mirror</a>`);let o=escapeString(n[e].title)||"no title";r.push([`${o} ${n[e]?.broadcaster_name?`<span class="text-body-secondary"> | (${n[e].broadcaster_name} clip)</span>`:""}`,escapeString(n[e].game_name||"no game"),secondsToDuration(n[e].duration),n[e].view_count.toLocaleString(),n[e].created_at,t,`<a href="/clip#${n[e]._id}" target="_blank" rel="noopener noreferrer" class="no-decoration">Link</a>`])}e.rows.add(r).draw()}catch(e){document.querySelector("#clipsTable > tbody > tr > td").innerHTML=`Could not load clips :(<br>${e}`,console.log(e)}}async function playClip(){let e=location.hash?.replace("#","")?.trim();if(console.log(e),e){document.getElementById("clipPlayer").src=`https://donk.forsen.horse/clip/${e}.mp4`;let t=await fetch(`https://guessr.donk.workers.dev/forsenclip/${e}`),n=await t.json();if(n[0]?.id){let e=n[0].creator_name||"unknown";"livestreamfails.com mirror"==e&&n[0].reddit_link&&(e=`<a href="${n[0].reddit_link}" target="_blank" rel="noopener noreferrer" class="no-decoration">livestreamfails.com mirror</a>`),document.getElementById("clipTitle").innerHTML=`${escapeString(n[0].title||"no title")} - ${escapeString(n[0].game_name||"no game")}`,document.getElementById("clipInfo").innerHTML=`${n[0].view_count.toLocaleString()} ${1==n[0].view_count?"view":"views"} - Clipped by ${e} on ${n[0].created_at}`}else document.getElementById("clipTitle").innerHTML="Clip info not found",document.getElementById("clipInfo").innerHTML="Clip info not found"}else document.getElementById("clipTitle").innerHTML="No Clip ID provided",document.getElementById("clipInfo").innerHTML='Go back to the <a href="/clips/"  rel="noopener noreferrer" class="no-decoration">Clips page</a> to search for clips'}function escapeString(e){return assertString(e),e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2F;").replace(/\\/g,"&#x5C;").replace(/`/g,"&#96;")}function assertString(e){if(!("string"==typeof e||e instanceof String)){let t=_typeof(e);throw null===e?t="null":"object"===t&&(t=e.constructor.name),new TypeError("Expected a string but received a ".concat(t))}}function secondsToDuration(e){const t=Math.round(e),n=Math.floor(t/3600),r=Math.floor(t%3600/60),o=t%60,a=String(r).padStart(2,"0"),i=String(o).padStart(2,"0");return n>0?`${String(n).padStart(2,"0")}:${a}:${i}`:`${a}:${i}`}